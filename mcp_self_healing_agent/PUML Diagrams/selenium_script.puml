@startuml SelfHealingSeleniumAgent
title Self-Healing Selenium Agent Script Flow

start

:runTest(byType, locator);
if (Test passes?) then (yes)
    :Return null;
else (no)
    :Collect error, stack trace, DOM snapshot;
    :Return failure context as map;
endif

:selfHeal(args);
:Call runTest(null, null);
if (result != null?) then (yes)
    :Send failure context to Lambda via API Gateway;
    :Receive Lambda suggestion;
    if (new_locator in Lambda response?) then (yes)
        :Parse new_locator;
        :Check for past fixes in FixesStore;
        if (Past fix found and passes?) then (yes)
            :Test passed after applying past fix;
        else (no)
            :Rerun runTest(byType, value) with Lambda suggestion;
            if (Test passes after fix?) then (yes)
                :Save fix to knowledge base (FixesStore);
            else (no)
                :Test still failed after applying Lambda suggestion;
            endif
        endif
    else (no)
        :No valid locator suggested by Lambda;
    endif
else (no)
    :Test passed, no Lambda call needed;
endif

stop

@enduml