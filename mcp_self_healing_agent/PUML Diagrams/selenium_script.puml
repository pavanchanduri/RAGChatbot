
@startuml SelfHealingSeleniumE2E
title Self-Healing Selenium Script - End to End Flow

actor "Test Automation" as TestRunner
entity "Selenium Script" as Selenium
entity "MCP Agent Lambda" as Lambda
entity "Bedrock LLM (LangChain)" as LLM
entity "Locator Extractor" as LocatorExtract
database "FixesStore (KB)" as KB

TestRunner --> Selenium : Run test (byType, locator)
Selenium --> TestRunner : Test result (pass/fail)
Selenium --> Lambda : Send failure context (error, stack, DOM)
Lambda --> LLM : Build prompt, request fix suggestion
LLM --> Lambda : Return fix suggestion (code, locator)
Lambda --> LocatorExtract : Extract new locator
LocatorExtract --> Lambda : Return new locator
Lambda --> Selenium : Return fix suggestion, new locator
Selenium --> KB : Check for past fixes
KB --> Selenium : Return past fix (if any)
Selenium --> TestRunner : Test result after self-heal
Selenium --> KB : Save successful fix

note right of Selenium
- Runs test and collects failure context
- Sends failure to Lambda
- Receives fix suggestion and locator
- Checks/saves fixes in KB
- Reruns test with fix
end note

@enduml